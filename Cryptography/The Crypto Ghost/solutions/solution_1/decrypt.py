
from Crypto.Util.number import long_to_bytes, bytes_to_long
from Crypto.PublicKey import RSA

# From public.pem file
e = 65537

# From public.pem file
n = 	106155323907403909438562352926585773437155103001267917294530081569386387405355531921505037979116509813154038501527851323605177606545005528914152284211666040268581803212014411414123026808444521460570885334885546040141936375595494374634322779128281634722160278251658662432604212978234098982516704046052964330395659009675742306409117882781017430637990926305487802634557334122404358725887497881514311918816298126963022850102409363060713180440879543921076948644740357092828684297561696478546762499401360239623808140354610606312266482131752623666558395261305103518283827047473130872942490035336760617448125882816842174499547324146944983089765860374393060705514484933242967224510778920005377518206290185507567922114409191167572644055745083055498499474076849175539621741840997927088002731514331350292151602406639706475097332087871693921698986541534038825701398668069141956703079703950156043409316841170001558385217364690350598184107591067991041056088382417265613067164672830966284565345761765380831223284706036326782522732321199456432705111982281174722316631427858999980262383472983957547893074712712276643414212397592909765204247502414931546833753380463609315135808501413950101437150296552880104461955470881446395602510960050722483794432078214142400161936955869033447642403498099867789691991817043984878645739661826872195122393319584448227691329151704418026836875677192669006827717717397799023535009638884539976733571320524301321283224130139145614588095629660693941711147851542957010002073413725528793373877378753850564347798537571495477070696796048178611104769496964745766800010079236503220356596718131098590168975405131290283525928443066197619585377812902841312152561511485267377116757493031679916667713953518140064739642600087871061477991509832231195106054566507725778366817541984544780640873432358614521522872376406146494982981109675801381119165943028315273552725451617819004944058836143680626831521479436960602039100488540966894066839276423635422789995368424964618779065233540343058346587236272490106632795966607388648709390316259688780624619414520532228177159594476667321124554256057751734249458778459837868985512422271295950148921747209228247502903324937034096243689481917599618758340480501953445526750476930132081905473022235267411159133342294172049131236637256655041726090444384338907409850627292434215435235577514805735030441631105224225205728561419013740253987115370299194114845378835785982652460814505915050551387533928023948389474472623365996290309510292592647
print("[+] Public Key: ", n)
print("[+] size: ", n.bit_length(), "bits")

#From the seed.txt. 
#As that is, base64 encoded
q = 273560417215500334242927473450977289098660657367726265901870473152020367529927822615492692103803245296608227436131427077345302347669996610089851682728800036535977878064912421926059236891863424248285293529595564935094786198628932510479710846859884992608179079457294588795015199983760606965838055054677335982981249023972841368638309408171427622721014112092031916605444195563874879140845063267704888701196884242590842470629698573894391946187530577007111717947223125736390767818476309330521649029073377300928148411595209562777963862082768780627648735743803076626550881008508917938212373635554418158262888937235243629108825205793396589683487926207789882941117486775746444801636109191787750045578057728133094734196188012532008883436648532464325125690281117725048757833105473430686288481011965004704378381023746860350888877576929730573497356020386427749091717546258133781682970794300585228605852389607310163193079480462418100249363814334415537202582212795103952036752280865637735840166535941830311032107472986482777603622117439261407667635507436864792813606528139545866460618387690964985851508087586619687482172189913806003024534683688283139461586915984777649854668333091199837490841348431348516321985683221760408464552133042255226761007439


p =  n // q
print(p)

primes_arr = [p, q]


# Calculate totient 'Phi(n)'
phi = 1
for k in primes_arr:
    phi *= (k - 1)

# Calculate private key 'd'
d = pow(e, -1, phi)

# Read the encrypted flag from the file
with open("flag_encrypted.txt", "rb") as flag_file:
    _enc = int.from_bytes(flag_file.read(), byteorder="little")

# Decrypt  Flag
dec_flag = pow(_enc, d, n)

# Convert the decrypted integer back to bytes
decrypted_text_bytes = dec_flag.to_bytes((dec_flag.bit_length() + 7) // 8, byteorder="big")

# Print the decrypted text
decrypted_text = decrypted_text_bytes.decode()
print("Decrypted:", decrypted_text)



